{
    "_ih": [
        "",
        "# Example metrics per epoch\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n\n# Extract epochs and metric keys\nepochs = list(range(1, len(train_metrics)+1))\nmetric_keys = list(train_metrics[0].keys())\ntest_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\ntrain_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\n\n# Create subplots\nfig, axes = plt.subplots(len(metric_keys), 1, figsize=(8, 4 * len(metric_keys)))\n\nfor i, key in enumerate(metric_keys):\n    ax = axes[i] if len(metric_keys) > 1 else axes\n    ax.plot(epochs, data[key], marker='o', color='tab:blue')\n    ax.plot(epochs, data[key], marker='o', color='tab:blue')\n    ax.set_title(f\"{key} over Epochs\")\n    ax.set_xlabel(\"Epoch\")\n    ax.set_ylabel(key)\n    ax.grid(True)\n    ax.set_xticks(epochs)\n\nplt.tight_layout()\nplt.show()",
        "# Example metrics per epoch\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\ntest_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n\n# Extract epochs and metric keys\nepochs = list(range(1, len(train_metrics)+1))\nmetric_keys = list(train_metrics[0].keys())\n\ntrain_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\ntest_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\n\n# Create subplots\nfig, axes = plt.subplots(len(metric_keys), 1, figsize=(8, 4 * len(metric_keys)))\n\nfor i, key in enumerate(metric_keys):\n    ax = axes[i] if len(metric_keys) > 1 else axes\n    ax.plot(epochs, train_metric_data[key], marker='o', color='tab:blue')\n    ax.plot(epochs, test_metric_data[key], marker='o', color='tab:orange')\n    ax.set_title(f\"{key} over Epochs\")\n    ax.set_xlabel(\"Epoch\")\n    ax.set_ylabel(key)\n    ax.grid(True)\n    ax.set_xticks(epochs)\n\nplt.tight_layout()\nplt.show()",
        "import sys\nimport time\nimport torch\nimport torch.nn.functional as F\nfrom torchvision.utils import make_grid\nfrom torch.amp import autocast, GradScaler\nfrom torch.utils.data import Dataset, DataLoader\nimport torchvision.transforms as T\nimport torchvision.utils as vutils\nimport matplotlib.pyplot as plt\n\nfrom lib.dataset import VideoClipDataset\nfrom lib.improve2VQ_GAN import VQVAE2VideoSystem\n\nfrom lib.eval import evaluate_model , print_evaluation_report\n\nfrom lib.train import train_epoch , setup_vgg , create_optimizers",
        "# Example metrics per epoch\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\ntest_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n\n# Extract epochs and metric keys\nepochs = list(range(1, len(train_metrics)+1))\nmetric_keys = list(train_metrics[0].keys())\n\ntrain_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\ntest_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\n\n# Create subplots\nfig, axes = plt.subplots(len(metric_keys), 1, figsize=(8, 4 * len(metric_keys)))\n\nfor i, key in enumerate(metric_keys):\n    ax = axes[i] if len(metric_keys) > 1 else axes\n    ax.plot(epochs, train_metric_data[key], marker='o', color='tab:blue')\n    ax.plot(epochs, test_metric_data[key], marker='o', color='tab:orange')\n    ax.set_title(f\"{key} over Epochs\")\n    ax.set_xlabel(\"Epoch\")\n    ax.set_ylabel(key)\n    ax.grid(True)\n    ax.set_xticks(epochs)\n\nplt.tight_layout()\nplt.show()",
        "# Example metrics per epoch\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\ntest_metrics = [\n    {\"accuracy\": 0.92, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n\n# Extract epochs and metric keys\nepochs = list(range(1, len(train_metrics)+1))\nmetric_keys = list(train_metrics[0].keys())\n\ntrain_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\ntest_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\n\n# Create subplots\nfig, axes = plt.subplots(len(metric_keys), 1, figsize=(8, 4 * len(metric_keys)))\n\nfor i, key in enumerate(metric_keys):\n    ax = axes[i] if len(metric_keys) > 1 else axes\n    ax.plot(epochs, train_metric_data[key], marker='o', color='tab:blue')\n    ax.plot(epochs, test_metric_data[key], marker='o', color='tab:orange')\n    ax.set_title(f\"{key} over Epochs\")\n    ax.set_xlabel(\"Epoch\")\n    ax.set_ylabel(key)\n    ax.grid(True)\n    ax.set_xticks(epochs)\n\nplt.tight_layout()\nplt.show()",
        "# Example metrics per epoch\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\ntest_metrics = [\n    {\"accuracy\": 0.1, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.2, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.3, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n\n# Extract epochs and metric keys\nepochs = list(range(1, len(train_metrics)+1))\nmetric_keys = list(train_metrics[0].keys())\n\ntrain_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\ntest_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\n\n# Create subplots\nfig, axes = plt.subplots(len(metric_keys), 1, figsize=(8, 4 * len(metric_keys)))\n\nfor i, key in enumerate(metric_keys):\n    ax = axes[i] if len(metric_keys) > 1 else axes\n    ax.plot(epochs, train_metric_data[key], marker='o', color='tab:blue')\n    ax.plot(epochs, test_metric_data[key], marker='o', color='tab:orange')\n    ax.set_title(f\"{key} over Epochs\")\n    ax.set_xlabel(\"Epoch\")\n    ax.set_ylabel(key)\n    ax.grid(True)\n    ax.set_xticks(epochs)\n\nplt.tight_layout()\nplt.show()",
        "# Example metrics per epoch\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\ntest_metrics = [\n    {\"accuracy\": 0.1, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.2, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.3, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n\n# Extract epochs and metric keys\nepochs = list(range(1, len(train_metrics)+1))\nmetric_keys = list(train_metrics[0].keys())\n\ntrain_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\ntest_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\n\n# Create subplots\nfig, axes = plt.subplots(len(metric_keys), 1, figsize=(8, 4 * len(metric_keys)))\n\nfor i, key in enumerate(metric_keys):\n    ax = axes[i] if len(metric_keys) > 1 else axes\n    ax.plot(epochs, train_metric_data[key], marker='o', color='tab:blue')\n    # ax.plot(epochs, test_metric_data[key], marker='o', color='tab:orange')\n    ax.set_title(f\"{key} over Epochs\")\n    ax.set_xlabel(\"Epoch\")\n    ax.set_ylabel(key)\n    ax.grid(True)\n    ax.set_xticks(epochs)\n\nplt.tight_layout()\nplt.show()",
        "# Example metrics per epoch\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\ntest_metrics = [\n    {\"accuracy\": 0.1, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.2, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.3, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n\n# Extract epochs and metric keys\nepochs = list(range(1, len(train_metrics)+1))\nmetric_keys = list(train_metrics[0].keys())\n\ntrain_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\ntest_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\n\n# Create subplots\nfig, axes = plt.subplots(len(metric_keys), 1, figsize=(8, 4 * len(metric_keys)))\n\nfor i, key in enumerate(metric_keys):\n    ax = axes[i] if len(metric_keys) > 1 else axes\n    ax.plot(epochs, train_metric_data[key], marker='o', color='tab:blue', label='Train')\n    ax.plot(epochs, test_metric_data[key], marker='o', color='tab:orange', label='Test')\n    ax.set_title(f\"{key} over Epochs\")\n    ax.set_xlabel(\"Epoch\")\n    ax.set_ylabel(key)\n    ax.grid(True)\n    ax.set_xticks(epochs)\n\nplt.tight_layout()\nplt.show()",
        "# Example metrics per epoch\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\ntest_metrics = [\n    {\"accuracy\": 0.1, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.2, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.3, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n\n# Extract epochs and metric keys\nepochs = list(range(1, len(train_metrics)+1))\nmetric_keys = list(train_metrics[0].keys())\n\ntrain_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\ntest_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\n\n# Create subplots\nfig, axes = plt.subplots(len(metric_keys), 1, figsize=(8, 4 * len(metric_keys)))\n\nfor i, key in enumerate(metric_keys):\n    ax = axes[i] if len(metric_keys) > 1 else axes\n\n    ax.plot(epochs, train_metric_data[key], marker='o', color='tab:blue', label='Train')\n    ax.plot(epochs, test_metric_data[key], marker='o', color='tab:orange', label='Test')\n\n    ax.set_title(f\"{key} over Epochs\")\n    ax.set_xlabel(\"Epoch\")\n    ax.set_ylabel(key)\n    ax.grid(True)\n    ax.set_xticks(epochs)\n    ax.legend()\n\nplt.tight_layout()\nplt.show()",
        "import matplotlib.pyplot as plt\n\n# Example metrics per epoch\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.10, \"f1\": 0.92},\n    {\"accuracy\": 0.96, \"loss\": 0.08, \"f1\": 0.93},\n    {\"accuracy\": 0.97, \"loss\": 0.07, \"f1\": 0.94},\n]\n\ntest_metrics = [\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},\n    {\"accuracy\": 0.93, \"loss\": 0.11, \"f1\": 0.90},\n    {\"accuracy\": 0.94, \"loss\": 0.10, \"f1\": 0.91},\n]\n\nepochs = list(range(1, len(train_metrics) + 1))\nmetric_keys = list(train_metrics[0].keys())\n\n# Convert to column-wise format\ntrain_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\ntest_metric_data  = {key: [m[key] for m in test_metrics] for key in metric_keys}\n\n# Plot subplots\nfig, axes = plt.subplots(len(metric_keys), 1, figsize=(10, 4 * len(metric_keys)))\n\nfor i, key in enumerate(metric_keys):\n    ax = axes[i] if len(metric_keys) > 1 else axes\n\n    # Train & Test lines\n    ax.plot(epochs, train_metric_data[key], marker='o', color='tab:blue', label='Train')\n    ax.plot(epochs, test_metric_data[key], marker='o', color='tab:orange', label='Test')\n\n    ax.set_title(f\"{key} over Epochs\")\n    ax.set_xlabel(\"Epoch\")\n    ax.set_ylabel(key)\n    ax.grid(True)\n    ax.set_xticks(epochs)\n    ax.legend()\n\nplt.tight_layout()\nplt.show()",
        "# Example metrics per epoch\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\ntest_metrics = [\n    {\"accuracy\": 0.1, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.2, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.3, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n\n# Extract epochs and metric keys\nepochs = list(range(1, len(train_metrics)+1))\nmetric_keys = list(train_metrics[0].keys())\n\ntrain_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\ntest_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\n\n# Create subplots\nfig, axes = plt.subplots(len(metric_keys), 1, figsize=(10, 4 * len(metric_keys)))\n\nfor i, key in enumerate(metric_keys):\n    ax = axes[i] if len(metric_keys) > 1 else axes\n\n    ax.plot(epochs, train_metric_data[key], marker='o', color='tab:blue', label='Train')\n    ax.plot(epochs, test_metric_data[key], marker='o', color='tab:orange', label='Test')\n\n    ax.set_title(f\"{key} over Epochs\")\n    ax.set_xlabel(\"Epoch\")\n    ax.set_ylabel(key)\n    ax.grid(True)\n    ax.set_xticks(epochs)\n    ax.legend()\n\nplt.tight_layout()\nplt.show()",
        "# Example metrics per epoch\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\ntest_metrics = [\n    {\"accuracy\": 0.1, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.2, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.3, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n\n# Extract epochs and metric keys\nepochs = list(range(1, len(train_metrics)+1))\nmetric_keys = list(train_metrics[0].keys())\n\ntrain_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\ntest_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\n\n# Create subplots\nfig, axes = plt.subplots(len(metric_keys), 1, figsize=(8, 4 * len(metric_keys)))\n\nfor i, key in enumerate(metric_keys):\n    ax = axes[i] if len(metric_keys) > 1 else axes\n\n    ax.plot(epochs, train_metric_data[key], marker='o', color='tab:blue', label='Train')\n    ax.plot(epochs, test_metric_data[key], marker='o', color='tab:orange', label='Test')\n\n    ax.set_title(f\"{key} over Epochs\")\n    ax.set_xlabel(\"Epoch\")\n    ax.set_ylabel(key)\n    ax.grid(True)\n    ax.set_xticks(epochs)\n    ax.legend()\n\nplt.tight_layout()\nplt.show()",
        "# Example metrics per epoch\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.10, \"f1\": 0.92},\n    {\"accuracy\": 0.96, \"loss\": 0.08, \"f1\": 0.93},\n    {\"accuracy\": 0.97, \"loss\": 0.07, \"f1\": 0.94},\n]\n\ntest_metrics = [\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},\n    {\"accuracy\": 0.93, \"loss\": 0.11, \"f1\": 0.90},\n    {\"accuracy\": 0.94, \"loss\": 0.10, \"f1\": 0.91},\n]\n\n\n# Extract epochs and metric keys\nepochs = list(range(1, len(train_metrics)+1))\nmetric_keys = list(train_metrics[0].keys())\n\ntrain_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\ntest_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\n\n# Create subplots\nfig, axes = plt.subplots(len(metric_keys), 1, figsize=(8, 4 * len(metric_keys)))\n\nfor i, key in enumerate(metric_keys):\n    ax = axes[i] if len(metric_keys) > 1 else axes\n\n    ax.plot(epochs, train_metric_data[key], marker='o', color='tab:blue', label='Train')\n    ax.plot(epochs, test_metric_data[key], marker='o', color='tab:orange', label='Test')\n\n    ax.set_title(f\"{key} over Epochs\")\n    ax.set_xlabel(\"Epoch\")\n    ax.set_ylabel(key)\n    ax.grid(True)\n    ax.set_xticks(epochs)\n    ax.legend()\n\nplt.tight_layout()\nplt.show()",
        "# Example metrics per epoch\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.10, \"f1\": 0.92},\n    {\"accuracy\": 0.96, \"loss\": 0.08, \"f1\": 0.93},\n    {\"accuracy\": 0.97, \"loss\": 0.07, \"f1\": 0.94},\n]\n\ntest_metrics = [\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},\n    {\"accuracy\": 0.93, \"loss\": 0.11, \"f1\": 0.90},\n    {\"accuracy\": 0.94, \"loss\": 0.10, \"f1\": 0.91},\n]\n\n\n# Extract epochs and metric keys\nepochs = list(range(1, len(train_metrics)+1))\nmetric_keys = list(train_metrics[0].keys())\n\ntrain_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\ntest_metric_data = {key: [m[key] for m in test_metrics] for key in metric_keys}\n\n# Create subplots\nfig, axes = plt.subplots(len(metric_keys), 1, figsize=(8, 4 * len(metric_keys)))\n\nfor i, key in enumerate(metric_keys):\n    ax = axes[i] if len(metric_keys) > 1 else axes\n\n    ax.plot(epochs, train_metric_data[key], marker='o', color='tab:blue', label='Train')\n    ax.plot(epochs, test_metric_data[key], marker='o', color='tab:orange', label='Test')\n\n    ax.set_title(f\"{key} over Epochs\")\n    ax.set_xlabel(\"Epoch\")\n    ax.set_ylabel(key)\n    ax.grid(True)\n    ax.set_xticks(epochs)\n    ax.legend()\n\nplt.tight_layout()\nplt.show()",
        "import json\n\ndef is_json_serializable(value):\n    try:\n        json.dumps(value)\n        return True\n    except Exception:\n        return False\n\n# Collect all JSON-safe variables\nexport_dict = {}\n\nfor name, value in globals().items():\n    # Skip special variables\n    if name.startswith(\"__\"):\n        continue\n\n    # Save only JSON-serializable values\n    if is_json_serializable(value):\n        export_dict[name] = value\n\n# Save to json\nwith open(\"notebook_vars.json\", \"w\") as f:\n    json.dump(export_dict, f, indent=4)\n\nprint(\"Saved variables:\", list(export_dict.keys()))",
        "import json\n\ndef is_json_serializable(value):\n    try:\n        json.dumps(value)\n        return True\n    except Exception:\n        return False\n\n# Collect all JSON-safe variables\nexport_dict = {}\n\nfor name, value in globals().items():\n    # Skip special variables\n    if name.startswith(\"__\"):\n        continue\n\n    # Save only JSON-serializable values\n    if is_json_serializable(value):\n        export_dict[name] = value\n\n# Save to json\nwith open(\"notebook_vars.json\", \"w\") as f:\n    json.dump(export_dict, f, indent=4)\n\nprint(\"Saved variables:\", list(export_dict.keys()))"
    ],
    "_oh": {},
    "In": [
        "",
        "# Example metrics per epoch\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n\n# Extract epochs and metric keys\nepochs = list(range(1, len(train_metrics)+1))\nmetric_keys = list(train_metrics[0].keys())\ntest_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\ntrain_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\n\n# Create subplots\nfig, axes = plt.subplots(len(metric_keys), 1, figsize=(8, 4 * len(metric_keys)))\n\nfor i, key in enumerate(metric_keys):\n    ax = axes[i] if len(metric_keys) > 1 else axes\n    ax.plot(epochs, data[key], marker='o', color='tab:blue')\n    ax.plot(epochs, data[key], marker='o', color='tab:blue')\n    ax.set_title(f\"{key} over Epochs\")\n    ax.set_xlabel(\"Epoch\")\n    ax.set_ylabel(key)\n    ax.grid(True)\n    ax.set_xticks(epochs)\n\nplt.tight_layout()\nplt.show()",
        "# Example metrics per epoch\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\ntest_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n\n# Extract epochs and metric keys\nepochs = list(range(1, len(train_metrics)+1))\nmetric_keys = list(train_metrics[0].keys())\n\ntrain_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\ntest_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\n\n# Create subplots\nfig, axes = plt.subplots(len(metric_keys), 1, figsize=(8, 4 * len(metric_keys)))\n\nfor i, key in enumerate(metric_keys):\n    ax = axes[i] if len(metric_keys) > 1 else axes\n    ax.plot(epochs, train_metric_data[key], marker='o', color='tab:blue')\n    ax.plot(epochs, test_metric_data[key], marker='o', color='tab:orange')\n    ax.set_title(f\"{key} over Epochs\")\n    ax.set_xlabel(\"Epoch\")\n    ax.set_ylabel(key)\n    ax.grid(True)\n    ax.set_xticks(epochs)\n\nplt.tight_layout()\nplt.show()",
        "import sys\nimport time\nimport torch\nimport torch.nn.functional as F\nfrom torchvision.utils import make_grid\nfrom torch.amp import autocast, GradScaler\nfrom torch.utils.data import Dataset, DataLoader\nimport torchvision.transforms as T\nimport torchvision.utils as vutils\nimport matplotlib.pyplot as plt\n\nfrom lib.dataset import VideoClipDataset\nfrom lib.improve2VQ_GAN import VQVAE2VideoSystem\n\nfrom lib.eval import evaluate_model , print_evaluation_report\n\nfrom lib.train import train_epoch , setup_vgg , create_optimizers",
        "# Example metrics per epoch\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\ntest_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n\n# Extract epochs and metric keys\nepochs = list(range(1, len(train_metrics)+1))\nmetric_keys = list(train_metrics[0].keys())\n\ntrain_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\ntest_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\n\n# Create subplots\nfig, axes = plt.subplots(len(metric_keys), 1, figsize=(8, 4 * len(metric_keys)))\n\nfor i, key in enumerate(metric_keys):\n    ax = axes[i] if len(metric_keys) > 1 else axes\n    ax.plot(epochs, train_metric_data[key], marker='o', color='tab:blue')\n    ax.plot(epochs, test_metric_data[key], marker='o', color='tab:orange')\n    ax.set_title(f\"{key} over Epochs\")\n    ax.set_xlabel(\"Epoch\")\n    ax.set_ylabel(key)\n    ax.grid(True)\n    ax.set_xticks(epochs)\n\nplt.tight_layout()\nplt.show()",
        "# Example metrics per epoch\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\ntest_metrics = [\n    {\"accuracy\": 0.92, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n\n# Extract epochs and metric keys\nepochs = list(range(1, len(train_metrics)+1))\nmetric_keys = list(train_metrics[0].keys())\n\ntrain_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\ntest_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\n\n# Create subplots\nfig, axes = plt.subplots(len(metric_keys), 1, figsize=(8, 4 * len(metric_keys)))\n\nfor i, key in enumerate(metric_keys):\n    ax = axes[i] if len(metric_keys) > 1 else axes\n    ax.plot(epochs, train_metric_data[key], marker='o', color='tab:blue')\n    ax.plot(epochs, test_metric_data[key], marker='o', color='tab:orange')\n    ax.set_title(f\"{key} over Epochs\")\n    ax.set_xlabel(\"Epoch\")\n    ax.set_ylabel(key)\n    ax.grid(True)\n    ax.set_xticks(epochs)\n\nplt.tight_layout()\nplt.show()",
        "# Example metrics per epoch\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\ntest_metrics = [\n    {\"accuracy\": 0.1, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.2, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.3, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n\n# Extract epochs and metric keys\nepochs = list(range(1, len(train_metrics)+1))\nmetric_keys = list(train_metrics[0].keys())\n\ntrain_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\ntest_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\n\n# Create subplots\nfig, axes = plt.subplots(len(metric_keys), 1, figsize=(8, 4 * len(metric_keys)))\n\nfor i, key in enumerate(metric_keys):\n    ax = axes[i] if len(metric_keys) > 1 else axes\n    ax.plot(epochs, train_metric_data[key], marker='o', color='tab:blue')\n    ax.plot(epochs, test_metric_data[key], marker='o', color='tab:orange')\n    ax.set_title(f\"{key} over Epochs\")\n    ax.set_xlabel(\"Epoch\")\n    ax.set_ylabel(key)\n    ax.grid(True)\n    ax.set_xticks(epochs)\n\nplt.tight_layout()\nplt.show()",
        "# Example metrics per epoch\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\ntest_metrics = [\n    {\"accuracy\": 0.1, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.2, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.3, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n\n# Extract epochs and metric keys\nepochs = list(range(1, len(train_metrics)+1))\nmetric_keys = list(train_metrics[0].keys())\n\ntrain_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\ntest_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\n\n# Create subplots\nfig, axes = plt.subplots(len(metric_keys), 1, figsize=(8, 4 * len(metric_keys)))\n\nfor i, key in enumerate(metric_keys):\n    ax = axes[i] if len(metric_keys) > 1 else axes\n    ax.plot(epochs, train_metric_data[key], marker='o', color='tab:blue')\n    # ax.plot(epochs, test_metric_data[key], marker='o', color='tab:orange')\n    ax.set_title(f\"{key} over Epochs\")\n    ax.set_xlabel(\"Epoch\")\n    ax.set_ylabel(key)\n    ax.grid(True)\n    ax.set_xticks(epochs)\n\nplt.tight_layout()\nplt.show()",
        "# Example metrics per epoch\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\ntest_metrics = [\n    {\"accuracy\": 0.1, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.2, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.3, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n\n# Extract epochs and metric keys\nepochs = list(range(1, len(train_metrics)+1))\nmetric_keys = list(train_metrics[0].keys())\n\ntrain_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\ntest_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\n\n# Create subplots\nfig, axes = plt.subplots(len(metric_keys), 1, figsize=(8, 4 * len(metric_keys)))\n\nfor i, key in enumerate(metric_keys):\n    ax = axes[i] if len(metric_keys) > 1 else axes\n    ax.plot(epochs, train_metric_data[key], marker='o', color='tab:blue', label='Train')\n    ax.plot(epochs, test_metric_data[key], marker='o', color='tab:orange', label='Test')\n    ax.set_title(f\"{key} over Epochs\")\n    ax.set_xlabel(\"Epoch\")\n    ax.set_ylabel(key)\n    ax.grid(True)\n    ax.set_xticks(epochs)\n\nplt.tight_layout()\nplt.show()",
        "# Example metrics per epoch\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\ntest_metrics = [\n    {\"accuracy\": 0.1, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.2, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.3, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n\n# Extract epochs and metric keys\nepochs = list(range(1, len(train_metrics)+1))\nmetric_keys = list(train_metrics[0].keys())\n\ntrain_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\ntest_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\n\n# Create subplots\nfig, axes = plt.subplots(len(metric_keys), 1, figsize=(8, 4 * len(metric_keys)))\n\nfor i, key in enumerate(metric_keys):\n    ax = axes[i] if len(metric_keys) > 1 else axes\n\n    ax.plot(epochs, train_metric_data[key], marker='o', color='tab:blue', label='Train')\n    ax.plot(epochs, test_metric_data[key], marker='o', color='tab:orange', label='Test')\n\n    ax.set_title(f\"{key} over Epochs\")\n    ax.set_xlabel(\"Epoch\")\n    ax.set_ylabel(key)\n    ax.grid(True)\n    ax.set_xticks(epochs)\n    ax.legend()\n\nplt.tight_layout()\nplt.show()",
        "import matplotlib.pyplot as plt\n\n# Example metrics per epoch\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.10, \"f1\": 0.92},\n    {\"accuracy\": 0.96, \"loss\": 0.08, \"f1\": 0.93},\n    {\"accuracy\": 0.97, \"loss\": 0.07, \"f1\": 0.94},\n]\n\ntest_metrics = [\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},\n    {\"accuracy\": 0.93, \"loss\": 0.11, \"f1\": 0.90},\n    {\"accuracy\": 0.94, \"loss\": 0.10, \"f1\": 0.91},\n]\n\nepochs = list(range(1, len(train_metrics) + 1))\nmetric_keys = list(train_metrics[0].keys())\n\n# Convert to column-wise format\ntrain_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\ntest_metric_data  = {key: [m[key] for m in test_metrics] for key in metric_keys}\n\n# Plot subplots\nfig, axes = plt.subplots(len(metric_keys), 1, figsize=(10, 4 * len(metric_keys)))\n\nfor i, key in enumerate(metric_keys):\n    ax = axes[i] if len(metric_keys) > 1 else axes\n\n    # Train & Test lines\n    ax.plot(epochs, train_metric_data[key], marker='o', color='tab:blue', label='Train')\n    ax.plot(epochs, test_metric_data[key], marker='o', color='tab:orange', label='Test')\n\n    ax.set_title(f\"{key} over Epochs\")\n    ax.set_xlabel(\"Epoch\")\n    ax.set_ylabel(key)\n    ax.grid(True)\n    ax.set_xticks(epochs)\n    ax.legend()\n\nplt.tight_layout()\nplt.show()",
        "# Example metrics per epoch\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\ntest_metrics = [\n    {\"accuracy\": 0.1, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.2, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.3, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n\n# Extract epochs and metric keys\nepochs = list(range(1, len(train_metrics)+1))\nmetric_keys = list(train_metrics[0].keys())\n\ntrain_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\ntest_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\n\n# Create subplots\nfig, axes = plt.subplots(len(metric_keys), 1, figsize=(10, 4 * len(metric_keys)))\n\nfor i, key in enumerate(metric_keys):\n    ax = axes[i] if len(metric_keys) > 1 else axes\n\n    ax.plot(epochs, train_metric_data[key], marker='o', color='tab:blue', label='Train')\n    ax.plot(epochs, test_metric_data[key], marker='o', color='tab:orange', label='Test')\n\n    ax.set_title(f\"{key} over Epochs\")\n    ax.set_xlabel(\"Epoch\")\n    ax.set_ylabel(key)\n    ax.grid(True)\n    ax.set_xticks(epochs)\n    ax.legend()\n\nplt.tight_layout()\nplt.show()",
        "# Example metrics per epoch\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\ntest_metrics = [\n    {\"accuracy\": 0.1, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.2, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.3, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n\n# Extract epochs and metric keys\nepochs = list(range(1, len(train_metrics)+1))\nmetric_keys = list(train_metrics[0].keys())\n\ntrain_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\ntest_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\n\n# Create subplots\nfig, axes = plt.subplots(len(metric_keys), 1, figsize=(8, 4 * len(metric_keys)))\n\nfor i, key in enumerate(metric_keys):\n    ax = axes[i] if len(metric_keys) > 1 else axes\n\n    ax.plot(epochs, train_metric_data[key], marker='o', color='tab:blue', label='Train')\n    ax.plot(epochs, test_metric_data[key], marker='o', color='tab:orange', label='Test')\n\n    ax.set_title(f\"{key} over Epochs\")\n    ax.set_xlabel(\"Epoch\")\n    ax.set_ylabel(key)\n    ax.grid(True)\n    ax.set_xticks(epochs)\n    ax.legend()\n\nplt.tight_layout()\nplt.show()",
        "# Example metrics per epoch\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.10, \"f1\": 0.92},\n    {\"accuracy\": 0.96, \"loss\": 0.08, \"f1\": 0.93},\n    {\"accuracy\": 0.97, \"loss\": 0.07, \"f1\": 0.94},\n]\n\ntest_metrics = [\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},\n    {\"accuracy\": 0.93, \"loss\": 0.11, \"f1\": 0.90},\n    {\"accuracy\": 0.94, \"loss\": 0.10, \"f1\": 0.91},\n]\n\n\n# Extract epochs and metric keys\nepochs = list(range(1, len(train_metrics)+1))\nmetric_keys = list(train_metrics[0].keys())\n\ntrain_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\ntest_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\n\n# Create subplots\nfig, axes = plt.subplots(len(metric_keys), 1, figsize=(8, 4 * len(metric_keys)))\n\nfor i, key in enumerate(metric_keys):\n    ax = axes[i] if len(metric_keys) > 1 else axes\n\n    ax.plot(epochs, train_metric_data[key], marker='o', color='tab:blue', label='Train')\n    ax.plot(epochs, test_metric_data[key], marker='o', color='tab:orange', label='Test')\n\n    ax.set_title(f\"{key} over Epochs\")\n    ax.set_xlabel(\"Epoch\")\n    ax.set_ylabel(key)\n    ax.grid(True)\n    ax.set_xticks(epochs)\n    ax.legend()\n\nplt.tight_layout()\nplt.show()",
        "# Example metrics per epoch\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.10, \"f1\": 0.92},\n    {\"accuracy\": 0.96, \"loss\": 0.08, \"f1\": 0.93},\n    {\"accuracy\": 0.97, \"loss\": 0.07, \"f1\": 0.94},\n]\n\ntest_metrics = [\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},\n    {\"accuracy\": 0.93, \"loss\": 0.11, \"f1\": 0.90},\n    {\"accuracy\": 0.94, \"loss\": 0.10, \"f1\": 0.91},\n]\n\n\n# Extract epochs and metric keys\nepochs = list(range(1, len(train_metrics)+1))\nmetric_keys = list(train_metrics[0].keys())\n\ntrain_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\ntest_metric_data = {key: [m[key] for m in test_metrics] for key in metric_keys}\n\n# Create subplots\nfig, axes = plt.subplots(len(metric_keys), 1, figsize=(8, 4 * len(metric_keys)))\n\nfor i, key in enumerate(metric_keys):\n    ax = axes[i] if len(metric_keys) > 1 else axes\n\n    ax.plot(epochs, train_metric_data[key], marker='o', color='tab:blue', label='Train')\n    ax.plot(epochs, test_metric_data[key], marker='o', color='tab:orange', label='Test')\n\n    ax.set_title(f\"{key} over Epochs\")\n    ax.set_xlabel(\"Epoch\")\n    ax.set_ylabel(key)\n    ax.grid(True)\n    ax.set_xticks(epochs)\n    ax.legend()\n\nplt.tight_layout()\nplt.show()",
        "import json\n\ndef is_json_serializable(value):\n    try:\n        json.dumps(value)\n        return True\n    except Exception:\n        return False\n\n# Collect all JSON-safe variables\nexport_dict = {}\n\nfor name, value in globals().items():\n    # Skip special variables\n    if name.startswith(\"__\"):\n        continue\n\n    # Save only JSON-serializable values\n    if is_json_serializable(value):\n        export_dict[name] = value\n\n# Save to json\nwith open(\"notebook_vars.json\", \"w\") as f:\n    json.dump(export_dict, f, indent=4)\n\nprint(\"Saved variables:\", list(export_dict.keys()))",
        "import json\n\ndef is_json_serializable(value):\n    try:\n        json.dumps(value)\n        return True\n    except Exception:\n        return False\n\n# Collect all JSON-safe variables\nexport_dict = {}\n\nfor name, value in globals().items():\n    # Skip special variables\n    if name.startswith(\"__\"):\n        continue\n\n    # Save only JSON-serializable values\n    if is_json_serializable(value):\n        export_dict[name] = value\n\n# Save to json\nwith open(\"notebook_vars.json\", \"w\") as f:\n    json.dump(export_dict, f, indent=4)\n\nprint(\"Saved variables:\", list(export_dict.keys()))"
    ],
    "Out": {},
    "_": "",
    "_i": "import json\n\ndef is_json_serializable(value):\n    try:\n        json.dumps(value)\n        return True\n    except Exception:\n        return False\n\n# Collect all JSON-safe variables\nexport_dict = {}\n\nfor name, value in globals().items():\n    # Skip special variables\n    if name.startswith(\"__\"):\n        continue\n\n    # Save only JSON-serializable values\n    if is_json_serializable(value):\n        export_dict[name] = value\n\n# Save to json\nwith open(\"notebook_vars.json\", \"w\") as f:\n    json.dump(export_dict, f, indent=4)\n\nprint(\"Saved variables:\", list(export_dict.keys()))",
    "_ii": "# Example metrics per epoch\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.10, \"f1\": 0.92},\n    {\"accuracy\": 0.96, \"loss\": 0.08, \"f1\": 0.93},\n    {\"accuracy\": 0.97, \"loss\": 0.07, \"f1\": 0.94},\n]\n\ntest_metrics = [\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},\n    {\"accuracy\": 0.93, \"loss\": 0.11, \"f1\": 0.90},\n    {\"accuracy\": 0.94, \"loss\": 0.10, \"f1\": 0.91},\n]\n\n\n# Extract epochs and metric keys\nepochs = list(range(1, len(train_metrics)+1))\nmetric_keys = list(train_metrics[0].keys())\n\ntrain_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\ntest_metric_data = {key: [m[key] for m in test_metrics] for key in metric_keys}\n\n# Create subplots\nfig, axes = plt.subplots(len(metric_keys), 1, figsize=(8, 4 * len(metric_keys)))\n\nfor i, key in enumerate(metric_keys):\n    ax = axes[i] if len(metric_keys) > 1 else axes\n\n    ax.plot(epochs, train_metric_data[key], marker='o', color='tab:blue', label='Train')\n    ax.plot(epochs, test_metric_data[key], marker='o', color='tab:orange', label='Test')\n    \n    ax.set_title(f\"{key} over Epochs\")\n    ax.set_xlabel(\"Epoch\")\n    ax.set_ylabel(key)\n    ax.grid(True)\n    ax.set_xticks(epochs)\n    ax.legend()\n    \nplt.tight_layout()\nplt.show()",
    "_iii": "# Example metrics per epoch\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.10, \"f1\": 0.92},\n    {\"accuracy\": 0.96, \"loss\": 0.08, \"f1\": 0.93},\n    {\"accuracy\": 0.97, \"loss\": 0.07, \"f1\": 0.94},\n]\n\ntest_metrics = [\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},\n    {\"accuracy\": 0.93, \"loss\": 0.11, \"f1\": 0.90},\n    {\"accuracy\": 0.94, \"loss\": 0.10, \"f1\": 0.91},\n]\n\n\n# Extract epochs and metric keys\nepochs = list(range(1, len(train_metrics)+1))\nmetric_keys = list(train_metrics[0].keys())\n\ntrain_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\ntest_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\n\n# Create subplots\nfig, axes = plt.subplots(len(metric_keys), 1, figsize=(8, 4 * len(metric_keys)))\n\nfor i, key in enumerate(metric_keys):\n    ax = axes[i] if len(metric_keys) > 1 else axes\n\n    ax.plot(epochs, train_metric_data[key], marker='o', color='tab:blue', label='Train')\n    ax.plot(epochs, test_metric_data[key], marker='o', color='tab:orange', label='Test')\n    \n    ax.set_title(f\"{key} over Epochs\")\n    ax.set_xlabel(\"Epoch\")\n    ax.set_ylabel(key)\n    ax.grid(True)\n    ax.set_xticks(epochs)\n    ax.legend()\n    \nplt.tight_layout()\nplt.show()",
    "_i1": "# Example metrics per epoch\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n\n# Extract epochs and metric keys\nepochs = list(range(1, len(train_metrics)+1))\nmetric_keys = list(train_metrics[0].keys())\ntest_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\ntrain_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\n\n# Create subplots\nfig, axes = plt.subplots(len(metric_keys), 1, figsize=(8, 4 * len(metric_keys)))\n\nfor i, key in enumerate(metric_keys):\n    ax = axes[i] if len(metric_keys) > 1 else axes\n    ax.plot(epochs, data[key], marker='o', color='tab:blue')\n    ax.plot(epochs, data[key], marker='o', color='tab:blue')\n    ax.set_title(f\"{key} over Epochs\")\n    ax.set_xlabel(\"Epoch\")\n    ax.set_ylabel(key)\n    ax.grid(True)\n    ax.set_xticks(epochs)\n\nplt.tight_layout()\nplt.show()",
    "train_metrics": [
        {
            "accuracy": 0.95,
            "loss": 0.1,
            "f1": 0.92
        },
        {
            "accuracy": 0.96,
            "loss": 0.08,
            "f1": 0.93
        },
        {
            "accuracy": 0.97,
            "loss": 0.07,
            "f1": 0.94
        }
    ],
    "epochs": [
        1,
        2,
        3
    ],
    "metric_keys": [
        "accuracy",
        "loss",
        "f1"
    ],
    "test_metric_data": {
        "accuracy": [
            0.92,
            0.93,
            0.94
        ],
        "loss": [
            0.12,
            0.11,
            0.1
        ],
        "f1": [
            0.89,
            0.9,
            0.91
        ]
    },
    "train_metric_data": {
        "accuracy": [
            0.95,
            0.96,
            0.97
        ],
        "loss": [
            0.1,
            0.08,
            0.07
        ],
        "f1": [
            0.92,
            0.93,
            0.94
        ]
    },
    "_i2": "# Example metrics per epoch\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\ntest_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n\n# Extract epochs and metric keys\nepochs = list(range(1, len(train_metrics)+1))\nmetric_keys = list(train_metrics[0].keys())\n\ntrain_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\ntest_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\n\n# Create subplots\nfig, axes = plt.subplots(len(metric_keys), 1, figsize=(8, 4 * len(metric_keys)))\n\nfor i, key in enumerate(metric_keys):\n    ax = axes[i] if len(metric_keys) > 1 else axes\n    ax.plot(epochs, train_metric_data[key], marker='o', color='tab:blue')\n    ax.plot(epochs, test_metric_data[key], marker='o', color='tab:orange')\n    ax.set_title(f\"{key} over Epochs\")\n    ax.set_xlabel(\"Epoch\")\n    ax.set_ylabel(key)\n    ax.grid(True)\n    ax.set_xticks(epochs)\n\nplt.tight_layout()\nplt.show()",
    "test_metrics": [
        {
            "accuracy": 0.92,
            "loss": 0.12,
            "f1": 0.89
        },
        {
            "accuracy": 0.93,
            "loss": 0.11,
            "f1": 0.9
        },
        {
            "accuracy": 0.94,
            "loss": 0.1,
            "f1": 0.91
        }
    ],
    "_i3": "import sys\nimport time\nimport torch\nimport torch.nn.functional as F\nfrom torchvision.utils import make_grid\nfrom torch.amp import autocast, GradScaler\nfrom torch.utils.data import Dataset, DataLoader\nimport torchvision.transforms as T\nimport torchvision.utils as vutils\nimport matplotlib.pyplot as plt\n\nfrom lib.dataset import VideoClipDataset\nfrom lib.improve2VQ_GAN import VQVAE2VideoSystem\n\nfrom lib.eval import evaluate_model , print_evaluation_report\n\nfrom lib.train import train_epoch , setup_vgg , create_optimizers",
    "_i4": "# Example metrics per epoch\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\ntest_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n\n# Extract epochs and metric keys\nepochs = list(range(1, len(train_metrics)+1))\nmetric_keys = list(train_metrics[0].keys())\n\ntrain_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\ntest_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\n\n# Create subplots\nfig, axes = plt.subplots(len(metric_keys), 1, figsize=(8, 4 * len(metric_keys)))\n\nfor i, key in enumerate(metric_keys):\n    ax = axes[i] if len(metric_keys) > 1 else axes\n    ax.plot(epochs, train_metric_data[key], marker='o', color='tab:blue')\n    ax.plot(epochs, test_metric_data[key], marker='o', color='tab:orange')\n    ax.set_title(f\"{key} over Epochs\")\n    ax.set_xlabel(\"Epoch\")\n    ax.set_ylabel(key)\n    ax.grid(True)\n    ax.set_xticks(epochs)\n\nplt.tight_layout()\nplt.show()",
    "i": 2,
    "key": "f1",
    "_i5": "# Example metrics per epoch\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\ntest_metrics = [\n    {\"accuracy\": 0.92, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n\n# Extract epochs and metric keys\nepochs = list(range(1, len(train_metrics)+1))\nmetric_keys = list(train_metrics[0].keys())\n\ntrain_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\ntest_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\n\n# Create subplots\nfig, axes = plt.subplots(len(metric_keys), 1, figsize=(8, 4 * len(metric_keys)))\n\nfor i, key in enumerate(metric_keys):\n    ax = axes[i] if len(metric_keys) > 1 else axes\n    ax.plot(epochs, train_metric_data[key], marker='o', color='tab:blue')\n    ax.plot(epochs, test_metric_data[key], marker='o', color='tab:orange')\n    ax.set_title(f\"{key} over Epochs\")\n    ax.set_xlabel(\"Epoch\")\n    ax.set_ylabel(key)\n    ax.grid(True)\n    ax.set_xticks(epochs)\n\nplt.tight_layout()\nplt.show()",
    "_i6": "# Example metrics per epoch\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\ntest_metrics = [\n    {\"accuracy\": 0.1, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.2, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.3, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n\n# Extract epochs and metric keys\nepochs = list(range(1, len(train_metrics)+1))\nmetric_keys = list(train_metrics[0].keys())\n\ntrain_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\ntest_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\n\n# Create subplots\nfig, axes = plt.subplots(len(metric_keys), 1, figsize=(8, 4 * len(metric_keys)))\n\nfor i, key in enumerate(metric_keys):\n    ax = axes[i] if len(metric_keys) > 1 else axes\n    ax.plot(epochs, train_metric_data[key], marker='o', color='tab:blue')\n    ax.plot(epochs, test_metric_data[key], marker='o', color='tab:orange')\n    ax.set_title(f\"{key} over Epochs\")\n    ax.set_xlabel(\"Epoch\")\n    ax.set_ylabel(key)\n    ax.grid(True)\n    ax.set_xticks(epochs)\n\nplt.tight_layout()\nplt.show()",
    "_i7": "# Example metrics per epoch\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\ntest_metrics = [\n    {\"accuracy\": 0.1, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.2, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.3, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n\n# Extract epochs and metric keys\nepochs = list(range(1, len(train_metrics)+1))\nmetric_keys = list(train_metrics[0].keys())\n\ntrain_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\ntest_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\n\n# Create subplots\nfig, axes = plt.subplots(len(metric_keys), 1, figsize=(8, 4 * len(metric_keys)))\n\nfor i, key in enumerate(metric_keys):\n    ax = axes[i] if len(metric_keys) > 1 else axes\n    ax.plot(epochs, train_metric_data[key], marker='o', color='tab:blue')\n    # ax.plot(epochs, test_metric_data[key], marker='o', color='tab:orange')\n    ax.set_title(f\"{key} over Epochs\")\n    ax.set_xlabel(\"Epoch\")\n    ax.set_ylabel(key)\n    ax.grid(True)\n    ax.set_xticks(epochs)\n\nplt.tight_layout()\nplt.show()",
    "_i8": "# Example metrics per epoch\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\ntest_metrics = [\n    {\"accuracy\": 0.1, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.2, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.3, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n\n# Extract epochs and metric keys\nepochs = list(range(1, len(train_metrics)+1))\nmetric_keys = list(train_metrics[0].keys())\n\ntrain_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\ntest_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\n\n# Create subplots\nfig, axes = plt.subplots(len(metric_keys), 1, figsize=(8, 4 * len(metric_keys)))\n\nfor i, key in enumerate(metric_keys):\n    ax = axes[i] if len(metric_keys) > 1 else axes\n    ax.plot(epochs, train_metric_data[key], marker='o', color='tab:blue', label='Train')\n    ax.plot(epochs, test_metric_data[key], marker='o', color='tab:orange', label='Test')\n    ax.set_title(f\"{key} over Epochs\")\n    ax.set_xlabel(\"Epoch\")\n    ax.set_ylabel(key)\n    ax.grid(True)\n    ax.set_xticks(epochs)\n\nplt.tight_layout()\nplt.show()",
    "_i9": "# Example metrics per epoch\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\ntest_metrics = [\n    {\"accuracy\": 0.1, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.2, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.3, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n\n# Extract epochs and metric keys\nepochs = list(range(1, len(train_metrics)+1))\nmetric_keys = list(train_metrics[0].keys())\n\ntrain_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\ntest_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\n\n# Create subplots\nfig, axes = plt.subplots(len(metric_keys), 1, figsize=(8, 4 * len(metric_keys)))\n\nfor i, key in enumerate(metric_keys):\n    ax = axes[i] if len(metric_keys) > 1 else axes\n\n    ax.plot(epochs, train_metric_data[key], marker='o', color='tab:blue', label='Train')\n    ax.plot(epochs, test_metric_data[key], marker='o', color='tab:orange', label='Test')\n    \n    ax.set_title(f\"{key} over Epochs\")\n    ax.set_xlabel(\"Epoch\")\n    ax.set_ylabel(key)\n    ax.grid(True)\n    ax.set_xticks(epochs)\n    ax.legend()\n    \nplt.tight_layout()\nplt.show()",
    "_i10": "import matplotlib.pyplot as plt\n\n# Example metrics per epoch\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.10, \"f1\": 0.92},\n    {\"accuracy\": 0.96, \"loss\": 0.08, \"f1\": 0.93},\n    {\"accuracy\": 0.97, \"loss\": 0.07, \"f1\": 0.94},\n]\n\ntest_metrics = [\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},\n    {\"accuracy\": 0.93, \"loss\": 0.11, \"f1\": 0.90},\n    {\"accuracy\": 0.94, \"loss\": 0.10, \"f1\": 0.91},\n]\n\nepochs = list(range(1, len(train_metrics) + 1))\nmetric_keys = list(train_metrics[0].keys())\n\n# Convert to column-wise format\ntrain_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\ntest_metric_data  = {key: [m[key] for m in test_metrics] for key in metric_keys}\n\n# Plot subplots\nfig, axes = plt.subplots(len(metric_keys), 1, figsize=(10, 4 * len(metric_keys)))\n\nfor i, key in enumerate(metric_keys):\n    ax = axes[i] if len(metric_keys) > 1 else axes\n\n    # Train & Test lines\n    ax.plot(epochs, train_metric_data[key], marker='o', color='tab:blue', label='Train')\n    ax.plot(epochs, test_metric_data[key], marker='o', color='tab:orange', label='Test')\n\n    ax.set_title(f\"{key} over Epochs\")\n    ax.set_xlabel(\"Epoch\")\n    ax.set_ylabel(key)\n    ax.grid(True)\n    ax.set_xticks(epochs)\n    ax.legend()\n\nplt.tight_layout()\nplt.show()",
    "_i11": "# Example metrics per epoch\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\ntest_metrics = [\n    {\"accuracy\": 0.1, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.2, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.3, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n\n# Extract epochs and metric keys\nepochs = list(range(1, len(train_metrics)+1))\nmetric_keys = list(train_metrics[0].keys())\n\ntrain_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\ntest_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\n\n# Create subplots\nfig, axes = plt.subplots(len(metric_keys), 1, figsize=(10, 4 * len(metric_keys)))\n\nfor i, key in enumerate(metric_keys):\n    ax = axes[i] if len(metric_keys) > 1 else axes\n\n    ax.plot(epochs, train_metric_data[key], marker='o', color='tab:blue', label='Train')\n    ax.plot(epochs, test_metric_data[key], marker='o', color='tab:orange', label='Test')\n    \n    ax.set_title(f\"{key} over Epochs\")\n    ax.set_xlabel(\"Epoch\")\n    ax.set_ylabel(key)\n    ax.grid(True)\n    ax.set_xticks(epochs)\n    ax.legend()\n    \nplt.tight_layout()\nplt.show()",
    "_i12": "# Example metrics per epoch\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\ntest_metrics = [\n    {\"accuracy\": 0.1, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.2, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.3, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n\n# Extract epochs and metric keys\nepochs = list(range(1, len(train_metrics)+1))\nmetric_keys = list(train_metrics[0].keys())\n\ntrain_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\ntest_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\n\n# Create subplots\nfig, axes = plt.subplots(len(metric_keys), 1, figsize=(8, 4 * len(metric_keys)))\n\nfor i, key in enumerate(metric_keys):\n    ax = axes[i] if len(metric_keys) > 1 else axes\n\n    ax.plot(epochs, train_metric_data[key], marker='o', color='tab:blue', label='Train')\n    ax.plot(epochs, test_metric_data[key], marker='o', color='tab:orange', label='Test')\n    \n    ax.set_title(f\"{key} over Epochs\")\n    ax.set_xlabel(\"Epoch\")\n    ax.set_ylabel(key)\n    ax.grid(True)\n    ax.set_xticks(epochs)\n    ax.legend()\n    \nplt.tight_layout()\nplt.show()",
    "_i13": "# Example metrics per epoch\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.10, \"f1\": 0.92},\n    {\"accuracy\": 0.96, \"loss\": 0.08, \"f1\": 0.93},\n    {\"accuracy\": 0.97, \"loss\": 0.07, \"f1\": 0.94},\n]\n\ntest_metrics = [\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},\n    {\"accuracy\": 0.93, \"loss\": 0.11, \"f1\": 0.90},\n    {\"accuracy\": 0.94, \"loss\": 0.10, \"f1\": 0.91},\n]\n\n\n# Extract epochs and metric keys\nepochs = list(range(1, len(train_metrics)+1))\nmetric_keys = list(train_metrics[0].keys())\n\ntrain_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\ntest_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\n\n# Create subplots\nfig, axes = plt.subplots(len(metric_keys), 1, figsize=(8, 4 * len(metric_keys)))\n\nfor i, key in enumerate(metric_keys):\n    ax = axes[i] if len(metric_keys) > 1 else axes\n\n    ax.plot(epochs, train_metric_data[key], marker='o', color='tab:blue', label='Train')\n    ax.plot(epochs, test_metric_data[key], marker='o', color='tab:orange', label='Test')\n    \n    ax.set_title(f\"{key} over Epochs\")\n    ax.set_xlabel(\"Epoch\")\n    ax.set_ylabel(key)\n    ax.grid(True)\n    ax.set_xticks(epochs)\n    ax.legend()\n    \nplt.tight_layout()\nplt.show()",
    "_i14": "# Example metrics per epoch\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.1, \"f1\": 0.92},  # epoch 1\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},  # epoch 2\n    {\"accuracy\": 0.94, \"loss\": 0.09, \"f1\": 0.91}  # epoch 3\n]\n'''\ntrain_metrics = [\n    {\"accuracy\": 0.95, \"loss\": 0.10, \"f1\": 0.92},\n    {\"accuracy\": 0.96, \"loss\": 0.08, \"f1\": 0.93},\n    {\"accuracy\": 0.97, \"loss\": 0.07, \"f1\": 0.94},\n]\n\ntest_metrics = [\n    {\"accuracy\": 0.92, \"loss\": 0.12, \"f1\": 0.89},\n    {\"accuracy\": 0.93, \"loss\": 0.11, \"f1\": 0.90},\n    {\"accuracy\": 0.94, \"loss\": 0.10, \"f1\": 0.91},\n]\n\n\n# Extract epochs and metric keys\nepochs = list(range(1, len(train_metrics)+1))\nmetric_keys = list(train_metrics[0].keys())\n\ntrain_metric_data = {key: [m[key] for m in train_metrics] for key in metric_keys}\ntest_metric_data = {key: [m[key] for m in test_metrics] for key in metric_keys}\n\n# Create subplots\nfig, axes = plt.subplots(len(metric_keys), 1, figsize=(8, 4 * len(metric_keys)))\n\nfor i, key in enumerate(metric_keys):\n    ax = axes[i] if len(metric_keys) > 1 else axes\n\n    ax.plot(epochs, train_metric_data[key], marker='o', color='tab:blue', label='Train')\n    ax.plot(epochs, test_metric_data[key], marker='o', color='tab:orange', label='Test')\n    \n    ax.set_title(f\"{key} over Epochs\")\n    ax.set_xlabel(\"Epoch\")\n    ax.set_ylabel(key)\n    ax.grid(True)\n    ax.set_xticks(epochs)\n    ax.legend()\n    \nplt.tight_layout()\nplt.show()",
    "_i15": "import json\n\ndef is_json_serializable(value):\n    try:\n        json.dumps(value)\n        return True\n    except Exception:\n        return False\n\n# Collect all JSON-safe variables\nexport_dict = {}\n\nfor name, value in globals().items():\n    # Skip special variables\n    if name.startswith(\"__\"):\n        continue\n\n    # Save only JSON-serializable values\n    if is_json_serializable(value):\n        export_dict[name] = value\n\n# Save to json\nwith open(\"notebook_vars.json\", \"w\") as f:\n    json.dump(export_dict, f, indent=4)\n\nprint(\"Saved variables:\", list(export_dict.keys()))",
    "export_dict": 